/*!
 * ğŸŒ browser.js - ğŸŒ åŸºäºæµè§ˆå™¨å¼€å‘çš„å¸¸ç”¨å·¥å…·ç±»æ–¹æ³•æˆ–æµè§ˆå™¨ç›¸å…³çš„æ“ä½œï¼Œæ¯”å¦‚åˆ¤æ–­æµè§ˆå™¨ç±»å‹å’Œç‰ˆæœ¬ç­‰ã€‚
 * git+https://github.com/hai2007/browser.js.git
 *
 * author ä½ å¥½2007 < https://hai2007.gitee.io/sweethome >
 *
 * version 0.3.4
 *
 * Copyright (c) 2021-present hai2007 èµ°ä¸€æ­¥ï¼Œå†èµ°ä¸€æ­¥ã€‚
 * Released under the MIT license
 *
 * Date:Wed Jan 05 2022 14:49:02 GMT+0800 (ä¸­å›½æ ‡å‡†æ—¶é—´)
 */
(function(){"use strict";var r={whitespace:"[\\x20\\t\\r\\n\\f]"};function i(e,t){var n=document.defaultView&&document.defaultView.getComputedStyle?document.defaultView.getComputedStyle(e,null):e.currentStyle;return typeof t==="string"?n.getPropertyValue(t):n}function e(e){var t=document.getElementsByTagName("head")[0];t.style["color"]=e;var n=i(t,"color");var o=n.replace(/^rgba?\(([^)]+)\)$/,"$1").split(new RegExp("\\,"+r.whitespace));return[+o[0],+o[1],+o[2],o[3]==undefined?1:+o[3]]}var s={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};var a={stopPropagation:function(e){e=e||window.event;if(e.stopPropagation){e.stopPropagation()}else{e.cancelBubble=true}},preventDefault:function(e){e=e||window.event;if(e.preventDefault){e.preventDefault()}else{e.returnValue=false}},isNode:function(e){return e&&(e.nodeType===1||e.nodeType===9||e.nodeType===11)},bind:function(e,t,n){if(e.constructor===Array||e.constructor===NodeList||e.constructor===HTMLCollection){for(var o=0;o<e.length;o++){this.bind(e[o],t,n)}return}if(window.attachEvent)e.attachEvent("on"+t,n);else e.addEventListener(t,n,false)},unbind:function(e,t,n){if(e.constructor===Array||e.constructor===NodeList||e.constructor===HTMLCollection){for(var o=0;o<e.length;o++){this.unbind(e[o],t,n)}return}if(window.detachEvent)e.detachEvent("on"+t,n);else e.removeEventListener(t,n,false)},find:function(e,t,n){if(!this.isNode(e))return[];var o=e.getElementsByTagName(n||"*");var r=[];for(var i=0;i<o.length;i++){if(this.isNode(o[i])&&(typeof t!="function"||t(o[i])))r.push(o[i])}return r},children:function(e,t){var n=e.childNodes;var o=[];for(var r=0;r<n.length;r++){if(this.isNode(n[r])&&(typeof t!="function"||t(n[r])))o.push(n[r])}return o},hasClass:function(e,t,n){if(t.constructor!==Array)t=[t];var o=" "+(e.getAttribute("class")||"")+" ";for(var r=0;r<t.length;r++){if(o.indexOf(" "+t[r]+" ")>=0){if(n)return true}else{if(!n)return false}}return true},removeClass:function(e,t){var n=" "+(e.getAttribute("class")||"")+" ";var o=n.replace(" "+t.trim()+" "," ");e.setAttribute("class",o.trim())},addClass:function(e,t){if(this.hasClass(e,t))return;var n=e.getAttribute("class")||"";e.setAttribute("class",n+" "+t)},toNode:function(e,t){var n;if(t)n=document.createElementNS(s.svg,"svg");else{var o="div";if(/^<tr[> ]/.test(e)){o="tbody"}else if(/^<th[> ]/.test(e)||/^<td[> ]/.test(e)){o="tr"}else if(/^<thead[> ]/.test(e)||/^<tbody[> ]/.test(e)){o="table"}n=document.createElement(o)}n.innerHTML=e;var r=n.childNodes;for(var i=0;i<r.length;i++){if(this.isNode(r[i]))return r[i]}},trigger:function(e,t){if(document.createEventObject){e.fireEvent("on"+t,document.createEventObject())}else{var n=document.createEvent("HTMLEvents");n.initEvent(t,true,false);e.dispatchEvent(n)}},getStyle:function(e,t){var n=document.defaultView&&document.defaultView.getComputedStyle?document.defaultView.getComputedStyle(e,null):e.currentStyle;return typeof t==="string"?n.getPropertyValue(t):n},offsetPosition:function(e){var t=0;var n=0;n=e.offsetTop;t=e.offsetLeft;e=e.offsetParent;while(e){n+=e.offsetTop;t+=e.offsetLeft;e=e.offsetParent}return{left:t,top:n}},mousePosition:function(e,t){var n=e.getBoundingClientRect();if(!t||!t.clientX)throw new Error("Event is necessary!");return{x:t.clientX-n.left,y:t.clientY-n.top}},remove:function(e){e.parentNode.removeChild(e)},setStyles:function(e,t){for(var n in t)e.style[n]=t[n]},size:function(e,t){var n,o;if(t=="content"){o=e.clientWidth-(this.getStyle(e,"padding-left")+"").replace("px","")-(this.getStyle(e,"padding-right")+"").replace("px","");n=e.clientHeight-(this.getStyle(e,"padding-top")+"").replace("px","")-(this.getStyle(e,"padding-bottom")+"").replace("px","")}else if(t=="padding"){o=e.clientWidth;n=e.clientHeight}else if(t=="border"){o=e.offsetWidth;n=e.offsetHeight}else if(t=="scroll"){o=e.scrollWidth;n=e.scrollHeight}else{o=e.offsetWidth;n=e.offsetHeight}return{width:o,height:n}},append:function(e,t){var n=this.isNode(t)?t:this.toNode(t);e.appendChild(n);return n},prepend:function(e,t){var n=this.isNode(t)?t:this.toNode(t);e.insertBefore(n,e.childNodes[0]);return n},after:function(e,t){var n=this.isNode(t)?t:this.toNode(t);e.parentNode.insertBefore(n,e.nextSibling);return n},before:function(e,t){var n=this.isNode(t)?t:this.toNode(t);e.parentNode.insertBefore(n,e);return n}};var u={48:[0,")"],49:[1,"!"],50:[2,"@"],51:[3,"#"],52:[4,"$"],53:[5,"%"],54:[6,"^"],55:[7,"&"],56:[8,"*"],57:[9,"("],96:[0,0],97:1,98:2,99:3,100:4,101:5,102:6,103:7,104:8,105:9,106:"*",107:"+",109:"-",110:".",111:"/",65:["a","A"],66:["b","B"],67:["c","C"],68:["d","D"],69:["e","E"],70:["f","F"],71:["g","G"],72:["h","H"],73:["i","I"],74:["j","J"],75:["k","K"],76:["l","L"],77:["m","M"],78:["n","N"],79:["o","O"],80:["p","P"],81:["q","Q"],82:["r","R"],83:["s","S"],84:["t","T"],85:["u","U"],86:["v","V"],87:["w","W"],88:["x","X"],89:["y","Y"],90:["z","Z"],37:"left",38:"up",39:"right",40:"down",33:"page up",34:"page down",35:"end",36:"home",16:"shift",17:"ctrl",18:"alt",91:"command",92:"command",93:"command",9:"tab",20:"caps lock",32:"spacebar",8:"backspace",13:"enter",27:"esc",46:"delete",45:"insert",144:"number lock",145:"scroll lock",12:"clear",19:"pause",112:"f1",113:"f2",114:"f3",115:"f4",116:"f5",117:"f6",118:"f7",119:"f8",120:"f9",121:"f10",122:"f11",123:"f12",189:["-","_"],187:["=","+"],219:["[","{"],221:["]","}"],220:["\\","|"],186:[";",":"],222:["'",'"'],188:[",","<"],190:[".",">"],191:["/","?"],192:["`","~"]};var c=["shift","ctrl","alt"];function o(e){e=e||window.event;var t=e.keyCode||e.which;var n=u[t]||t;if(!n)return;if(n.constructor!==Array)n=[n,n];var o=n[0];var r=e.shiftKey?"shift+":"",i=e.altKey?"alt+":"",s=e.ctrlKey?"ctrl+":"";var a="",l=s+r+i;if(c.indexOf(n[0])>=0){n[0]=n[1]=""}var f=e.code=="Key"+e.key&&!r;a=l+(l==""&&f?n[1]:n[0]);if(n[0]==""){a=a.replace(/\+$/,"")}return a==""?o:a}function t(r){var i=document.getElementsByTagName("body")[0];a.bind(i,"keydown",function(e){var t=o(e);if(t=="up"){r({type:"lookUp"})}else if(t=="down"){r({type:"lookDown"})}else if(t=="left"){r({type:"lookLeft"})}else if(t=="right"){r({type:"lookRight"})}});var s=null;var t=function(e){if(s==null)return;var t=a.mousePosition(i,e);var n=[t.x-s.x,s.y-t.y];var o=[n[1],n[0]*-1,0];if(o[0]==0&&o[1]==0)return;r({type:"rotate",normal:o,dist:Math.abs(t.x-s.x)+Math.abs(t.y-s.y)});s=t};a.bind(i,"mousedown",function(e){s=a.mousePosition(i,e)});a.bind(i,"mouseup",function(e){s=null});a.bind(i,"mousemove",function(e){t(e)});a.bind(i,"touchend",function(e){s=null});a.bind(i,"touchstart",function(e){s=a.mousePosition(i,e.touches[0])});a.bind(i,"touchmove",function(e){t(e.touches[0])});let n=function(e){if(e==0)return;r({type:"scale",kind:e<0?"reduce":"enlarge",rate:Math.abs(e)})};a.bind(i,"mousewheel",function(e){n(e.wheelDelta)});if(window.addEventListener){window.addEventListener("DOMMouseScroll",function(e){n(-1*e.detail)},false)}}var n={formatColor:e,xhtml:a,getKeyString:o,viewHandler:t};if(typeof module==="object"&&typeof module.exports==="object"){module.exports=n}else{window.browser=n}})();